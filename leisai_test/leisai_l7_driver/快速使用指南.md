# é›·èµ›L7ä¼ºæœé©±åŠ¨å™¨ - å¿«é€Ÿä½¿ç”¨æŒ‡å—

## ä¸€ã€5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹

### 1. å®‰è£…é©±åŠ¨åº“

```bash
pip install pyserial
```

### 2. æœ€ç®€å•çš„ä¾‹å­

```python
from leisai import L7Driver

# è¿æ¥ä¼ºæœï¼ˆWindowsç”¨COM3ï¼ŒLinuxç”¨/dev/ttyUSB0ï¼‰
driver = L7Driver('COM3')
driver.connect()

# è¯»å–çŠ¶æ€
print(f"å½“å‰ä½ç½®ï¼š{driver.get_position()} è„‰å†²")
print(f"å½“å‰é€Ÿåº¦ï¼š{driver.get_speed()} RPM")

# æ–­å¼€è¿æ¥
driver.disconnect()
```

### 3. ä½¿ç”¨withè¯­å¥ï¼ˆæ¨èï¼‰

```python
from leisai import L7Driver

with L7Driver('COM3') as driver:
    # è‡ªåŠ¨è¿æ¥å’Œæ–­å¼€
    driver.servo_on()         # ä½¿èƒ½
    print(driver.get_position())
    driver.servo_off()        # æ–­ä½¿èƒ½
```

## äºŒã€å¸¸ç”¨æ“ä½œç¤ºä¾‹

### ğŸŸ¢ ä¼ºæœä½¿èƒ½/æ–­ä½¿èƒ½

```python
with L7Driver('COM3') as driver:
    # ä½¿èƒ½
    driver.servo_on()
    print("ä¼ºæœå·²ä½¿èƒ½")
    
    # ä½ çš„æ“ä½œ...
    
    # æ–­ä½¿èƒ½
    driver.servo_off()
    print("ä¼ºæœå·²æ–­ä½¿èƒ½")
```

### ğŸ“ è¯»å–ä½ç½®

```python
with L7Driver('COM3') as driver:
    position = driver.get_position()  # è„‰å†²æ•°
    print(f"å½“å‰ä½ç½®ï¼š{position} è„‰å†²")
    
    # è½¬æ¢ä¸ºåœˆæ•°ï¼ˆ17ä½ç¼–ç å™¨ï¼‰
    rounds = position / 131072
    print(f"å½“å‰ä½ç½®ï¼š{rounds:.2f} åœˆ")
```

### ğŸš€ JOGç‚¹åŠ¨

```python
with L7Driver('COM3') as driver:
    driver.servo_on()
    
    # æ­£è½¬
    driver.jog(speed=500, direction=True)
    time.sleep(2)  # è¿è¡Œ2ç§’
    
    # åè½¬
    driver.jog(speed=500, direction=False)
    time.sleep(2)  # è¿è¡Œ2ç§’
    
    # åœæ­¢
    driver.stop_jog()
    
    driver.servo_off()
```

### ğŸ  è‡ªåŠ¨å›é›¶

```python
with L7Driver('COM3') as driver:
    driver.servo_on()
    
    # å¼€å§‹å›é›¶
    driver.home(mode=0, high_speed=500, low_speed=50)
    
    # ç­‰å¾…å®Œæˆ
    while not driver.is_homing_complete():
        print("å›é›¶ä¸­...")
        time.sleep(0.5)
    
    print("å›é›¶å®Œæˆ!")
    driver.servo_off()
```

### âš¡ é€Ÿåº¦æ§åˆ¶

```python
from leisai import L7Driver, ControlMode

with L7Driver('COM3') as driver:
    # åˆ‡æ¢åˆ°é€Ÿåº¦æ¨¡å¼
    driver.set_control_mode(ControlMode.SPEED)
    
    # è®¾ç½®åŠ å‡é€Ÿæ—¶é—´
    driver.write_parameter('acceleration_time', 1000)  # 1ç§’
    driver.write_parameter('deceleration_time', 1000)  # 1ç§’
    
    driver.servo_on()
    
    # è®¾ç½®é€Ÿåº¦
    driver.write_parameter('speed_command_1', 1000)  # 1000 RPM
    time.sleep(5)
    
    # åœæ­¢
    driver.write_parameter('speed_command_1', 0)
    time.sleep(2)
    
    driver.servo_off()
```

### âš ï¸ æŠ¥è­¦å¤„ç†

```python
with L7Driver('COM3') as driver:
    # æ£€æŸ¥æŠ¥è­¦
    alarm = driver.get_alarm()
    
    if alarm:
        print(f"å‘ç°æŠ¥è­¦ï¼š{driver.get_alarm_description(alarm)}")
        
        # å¤ä½æŠ¥è­¦
        driver.reset_alarm()
        time.sleep(1)
        
        # å†æ¬¡æ£€æŸ¥
        if driver.get_alarm() == 0:
            print("æŠ¥è­¦å·²æ¸…é™¤")
    else:
        print("æ— æŠ¥è­¦")
```

### ğŸ’¾ å‚æ•°è¯»å†™

```python
with L7Driver('COM3') as driver:
    # è¯»å–å‚æ•°
    rigidity = driver.read_parameter('rigidity_level')
    print(f"å½“å‰åˆšæ€§ï¼š{rigidity}")
    
    # å†™å…¥å‚æ•°
    driver.set_rigidity(20)  # è®¾ç½®åˆšæ€§ä¸º20
    driver.set_inertia_ratio(200)  # è®¾ç½®æƒ¯é‡æ¯”200%
    
    # ä¿å­˜åˆ°EEPROMï¼ˆæ–­ç”µä¿æŒï¼‰
    driver.save_parameters()
    print("å‚æ•°å·²ä¿å­˜")
```

## ä¸‰ã€å®Œæ•´ç¤ºä¾‹ç¨‹åº

### ç¤ºä¾‹1ï¼šåŸºç¡€è¿åŠ¨æµ‹è¯•

```python
#!/usr/bin/env python
"""åŸºç¡€è¿åŠ¨æµ‹è¯•ç¨‹åº"""

from leisai import L7Driver
import time

def test_basic_motion():
    """æµ‹è¯•åŸºæœ¬è¿åŠ¨åŠŸèƒ½"""
    
    with L7Driver('COM3', slave_id=1) as driver:
        print("=" * 50)
        print("é›·èµ›L7ä¼ºæœæµ‹è¯•ç¨‹åº")
        print("=" * 50)
        
        # 1. æ£€æŸ¥è¿æ¥
        if not driver.is_connected:
            print("è¿æ¥å¤±è´¥!")
            return
        print("âœ“ è¿æ¥æˆåŠŸ")
        
        # 2. æ£€æŸ¥æŠ¥è­¦
        alarm = driver.get_alarm()
        if alarm:
            print(f"âœ— æœ‰æŠ¥è­¦ï¼š{driver.get_alarm_description(alarm)}")
            driver.reset_alarm()
            time.sleep(1)
        else:
            print("âœ“ æ— æŠ¥è­¦")
        
        # 3. ä¼ºæœä½¿èƒ½
        driver.servo_on()
        print("âœ“ ä¼ºæœå·²ä½¿èƒ½")
        
        # 4. JOGæµ‹è¯•
        print("\nå¼€å§‹JOGæµ‹è¯•...")
        print("  æ­£è½¬500RPM - 3ç§’")
        driver.jog(500, True)
        time.sleep(3)
        
        print("  åè½¬500RPM - 3ç§’")
        driver.jog(500, False)
        time.sleep(3)
        
        driver.stop_jog()
        print("âœ“ JOGæµ‹è¯•å®Œæˆ")
        
        # 5. è¯»å–æœ€ç»ˆä½ç½®
        final_pos = driver.get_position()
        print(f"\næœ€ç»ˆä½ç½®ï¼š{final_pos} è„‰å†²")
        
        # 6. ä¼ºæœæ–­ä½¿èƒ½
        driver.servo_off()
        print("âœ“ ä¼ºæœå·²æ–­ä½¿èƒ½")
        
        print("\næµ‹è¯•å®Œæˆï¼")

if __name__ == "__main__":
    test_basic_motion()
```

### ç¤ºä¾‹2ï¼šå‚æ•°é…ç½®å·¥å…·

```python
#!/usr/bin/env python
"""å‚æ•°é…ç½®å·¥å…·"""

from leisai import L7Driver
import json

def backup_parameters():
    """å¤‡ä»½å½“å‰å‚æ•°"""
    
    with L7Driver('COM3') as driver:
        print("è¯»å–å‚æ•°ä¸­...")
        
        # è¦å¤‡ä»½çš„å‚æ•°åˆ—è¡¨
        params_to_backup = [
            'rigidity_level',
            'inertia_ratio', 
            'position_loop_gain',
            'speed_loop_gain',
            'speed_loop_integral',
            'acceleration_time',
            'deceleration_time',
            'motor_max_speed'
        ]
        
        backup = {}
        for param in params_to_backup:
            value = driver.read_parameter(param)
            backup[param] = value
            print(f"  {param}: {value}")
        
        # ä¿å­˜åˆ°æ–‡ä»¶
        with open('servo_backup.json', 'w') as f:
            json.dump(backup, f, indent=2)
        
        print(f"\nå‚æ•°å·²å¤‡ä»½åˆ° servo_backup.json")

def restore_parameters():
    """æ¢å¤å‚æ•°"""
    
    with L7Driver('COM3') as driver:
        # è¯»å–å¤‡ä»½æ–‡ä»¶
        with open('servo_backup.json', 'r') as f:
            backup = json.load(f)
        
        print("æ¢å¤å‚æ•°ä¸­...")
        for param, value in backup.items():
            driver.write_parameter(param, value)
            print(f"  {param}: {value}")
        
        # ä¿å­˜åˆ°EEPROM
        driver.save_parameters()
        print("\nå‚æ•°å·²æ¢å¤å¹¶ä¿å­˜åˆ°EEPROM")

if __name__ == "__main__":
    import sys
    
    if len(sys.argv) < 2:
        print("ç”¨æ³•ï¼š")
        print("  python params.py backup  - å¤‡ä»½å‚æ•°")
        print("  python params.py restore - æ¢å¤å‚æ•°")
    elif sys.argv[1] == "backup":
        backup_parameters()
    elif sys.argv[1] == "restore":
        restore_parameters()
```

### ç¤ºä¾‹3ï¼šçŠ¶æ€ç›‘æ§å™¨

```python
#!/usr/bin/env python
"""å®æ—¶çŠ¶æ€ç›‘æ§å™¨"""

from leisai import L7Driver, AlarmCode
import time
import os

def clear_screen():
    os.system('cls' if os.name == 'nt' else 'clear')

def monitor_servo():
    """å®æ—¶ç›‘æ§ä¼ºæœçŠ¶æ€"""
    
    with L7Driver('COM3') as driver:
        driver.servo_on()
        
        try:
            while True:
                clear_screen()
                print("=" * 50)
                print("é›·èµ›L7ä¼ºæœçŠ¶æ€ç›‘æ§å™¨")
                print("=" * 50)
                
                # è¯»å–çŠ¶æ€
                position = driver.get_position()
                speed = driver.get_speed()
                torque = driver.get_torque()
                alarm = driver.get_alarm()
                
                # æ˜¾ç¤ºçŠ¶æ€
                print(f"\nä½ç½®: {position:8} è„‰å†² ({position/131072:.2f} åœˆ)")
                print(f"é€Ÿåº¦: {speed:8} RPM")
                print(f"è½¬çŸ©: {torque:8} %")
                
                if alarm == AlarmCode.NO_ALARM:
                    print(f"æŠ¥è­¦: æ— ")
                else:
                    print(f"æŠ¥è­¦: {driver.get_alarm_description(alarm)}")
                
                # çŠ¶æ€æŒ‡ç¤º
                print("\nçŠ¶æ€: ", end="")
                if driver.is_ready():
                    print("âœ… å°±ç»ª")
                else:
                    print("âš ï¸ æœªå°±ç»ª")
                
                print("\næŒ‰ Ctrl+C é€€å‡º")
                time.sleep(0.1)
                
        except KeyboardInterrupt:
            print("\n\nç›‘æ§å·²åœæ­¢")
            driver.servo_off()

if __name__ == "__main__":
    monitor_servo()
```

## å››ã€ä¸²å£é…ç½®

### Windowsç³»ç»Ÿ

1. æ‰“å¼€è®¾å¤‡ç®¡ç†å™¨
2. æŸ¥çœ‹"ç«¯å£(COMå’ŒLPT)"
3. æ‰¾åˆ°USBè½¬ä¸²å£è®¾å¤‡ï¼Œè®°ä¸‹COMå£å·

### Linuxç³»ç»Ÿ

```bash
# æŸ¥çœ‹ä¸²å£è®¾å¤‡
ls /dev/tty*

# é€šå¸¸æ˜¯
/dev/ttyUSB0  # USBè½¬ä¸²å£
/dev/ttyACM0  # Arduinoç±»è®¾å¤‡

# æ·»åŠ ç”¨æˆ·åˆ°dialoutç»„ï¼ˆè·å–ä¸²å£æƒé™ï¼‰
sudo usermod -a -G dialout $USER
# æ³¨é”€é‡æ–°ç™»å½•ç”Ÿæ•ˆ
```

### æµ‹è¯•ä¸²å£

```python
import serial.tools.list_ports

# åˆ—å‡ºæ‰€æœ‰ä¸²å£
ports = serial.tools.list_ports.comports()
for port in ports:
    print(f"{port.device}: {port.description}")

# æµ‹è¯•è¿æ¥
from leisai import L7Driver

for port in ['COM3', 'COM4', 'COM5']:
    try:
        driver = L7Driver(port, timeout=0.5)
        if driver.connect():
            print(f"âœ“ {port} è¿æ¥æˆåŠŸ")
            driver.disconnect()
            break
    except:
        print(f"âœ— {port} è¿æ¥å¤±è´¥")
```

## äº”ã€æ³¨æ„äº‹é¡¹

### âš¡ å®‰å…¨æ³¨æ„

1. **ä¸Šç”µé¡ºåº**ï¼šå…ˆæ¥çº¿ï¼Œåä¸Šç”µ
2. **æ€¥åœæŒ‰é’®**ï¼šç¡®ä¿æ€¥åœæŒ‰é’®å¯ç”¨
3. **åˆæ¬¡è°ƒè¯•**ï¼šç”µæœºç©ºè½½ï¼Œä½é€Ÿæµ‹è¯•
4. **å‚æ•°ä¿®æ”¹**ï¼šå…ˆå¤‡ä»½åŸå‚æ•°

### ğŸ”§ è°ƒè¯•æŠ€å·§

1. **é€šä¿¡é—®é¢˜**
   - æ£€æŸ¥æ¥çº¿ï¼šA+/B-ä¸è¦æ¥å
   - ç»ˆç«¯ç”µé˜»ï¼šRS485éœ€120Î©ç”µé˜»
   - æ³¢ç‰¹ç‡ï¼šé»˜è®¤38400

2. **æŠ¥è­¦å¤„ç†**
   - å…ˆè®°å½•æŠ¥è­¦ä»£ç 
   - æ’é™¤æ•…éšœåŸå› 
   - å¤ä½æŠ¥è­¦é‡è¯•

3. **æ€§èƒ½ä¼˜åŒ–**
   - ä»ä½åˆšæ€§å¼€å§‹è°ƒè¯•
   - ä½¿ç”¨è‡ªåŠ¨è°ƒè°åŠŸèƒ½
   - è®°å½•æœ€ä½³å‚æ•°ç»„åˆ

## å…­ã€æŠ€æœ¯æ”¯æŒ

- ğŸ“§ æŠ€æœ¯é‚®ç®±ï¼šsupport@leisai.com
- ğŸ“ æŠ€æœ¯ç”µè¯ï¼š0755-26433338
- ğŸ“– å®Œæ•´æ–‡æ¡£ï¼š[README_CN.md](README_CN.md)
- ğŸ’» ç¤ºä¾‹ä»£ç ï¼š[examples/](examples/)

---

ğŸ’¡ **æç¤º**ï¼šæœ¬æŒ‡å—åŒ…å«æœ€å¸¸ç”¨åŠŸèƒ½ï¼Œæ›´å¤šé«˜çº§åŠŸèƒ½è¯·æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ã€‚