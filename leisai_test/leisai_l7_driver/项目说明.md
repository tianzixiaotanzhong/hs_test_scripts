# 雷赛L7伺服驱动器Python控制库 - 项目说明

## 📁 项目结构

```
leisai-l7-driver/
│
├── leisai/                    # 【主包】Python包源代码
│   ├── __init__.py           # 包初始化，导出公共API
│   ├── py.typed              # PEP561类型标记文件
│   │
│   ├── core/                 # 【核心模块】业务逻辑
│   │   ├── __init__.py       # 模块初始化
│   │   ├── driver.py         # L7Driver主类（约500行）
│   │   ├── constants.py      # 常量和枚举定义（约300行）
│   │   ├── exceptions.py     # 异常类定义（约200行）
│   │   ├── parameters.py     # 参数管理器（约250行）
│   │   ├── motion.py         # 运动控制器（约400行）
│   │   └── monitor.py        # 状态监控器（约300行）
│   │
│   └── protocols/            # 【协议模块】通信实现
│       ├── __init__.py       # 模块初始化
│       ├── modbus.py         # Modbus RTU协议（约500行）
│       └── serial.py         # 串口通信层（约300行）
│
├── tests/                    # 【测试】单元测试
│   ├── __init__.py
│   └── test_modbus.py        # Modbus协议测试示例
│
├── examples/                 # 【示例】使用示例
│   └── basic_usage.py        # 基础用法示例（约400行）
│
├── docs/                     # 【文档】文档目录（预留）
│
├── setup.py                  # 安装配置脚本
├── pyproject.toml           # 现代Python项目配置
├── requirements.txt         # 依赖包列表
├── LICENSE                  # MIT开源协议
├── .gitignore              # Git忽略文件配置
│
├── README.md               # 【英文文档】完整的英文说明
├── README_CN.md            # 【中文文档】详细的中文使用教程
├── 快速使用指南.md           # 【快速指南】5分钟上手教程
├── 项目说明.md              # 【本文件】项目结构说明
│
└── leisai_doc.txt          # 【参考文档】L7原始技术手册

```

## 📊 代码统计

- **Python源代码**：约3000行
- **文档**：约2000行
- **测试代码**：约200行
- **总计**：约5200行

## 🎯 核心特性

### 1. 专业的架构设计
- ✅ 模块化设计，职责单一
- ✅ 依赖注入模式
- ✅ 完整类型注解
- ✅ 层次化异常体系
- ✅ 线程安全实现

### 2. 完整的功能覆盖
- ✅ Modbus RTU协议（CRC16、重试机制）
- ✅ 三种控制模式（位置/速度/转矩）
- ✅ PR路径控制（16条路径）
- ✅ 实时状态监控
- ✅ 参数管理（读写/导入导出/EEPROM）
- ✅ JOG运动
- ✅ 自动回零
- ✅ 报警处理

### 3. 易用性设计
- ✅ 简洁的API
- ✅ 上下文管理器
- ✅ 自动资源管理
- ✅ 详细的错误提示
- ✅ 丰富的使用示例

## 📚 文档体系

| 文档 | 用途 | 适合人群 |
|-----|------|---------|
| **快速使用指南.md** | 5分钟快速上手 | 初次使用者 |
| **README_CN.md** | 详细中文教程 | 中文用户 |
| **README.md** | 英文API文档 | 国际用户 |
| **examples/basic_usage.py** | 代码示例 | 开发者 |
| **leisai_doc.txt** | 原始技术手册 | 深度用户 |

## 🚀 快速开始

### 1. 安装

```bash
# 安装依赖
pip install pyserial

# 或安装整个包
pip install -e .
```

### 2. 最简单的例子

```python
from leisai import L7Driver

# 使用上下文管理器
with L7Driver('COM3') as driver:
    driver.servo_on()
    print(f"位置：{driver.get_position()}")
    driver.servo_off()
```

### 3. 运行示例

```bash
# 运行基础示例
python examples/basic_usage.py
```

## 🔧 开发指南

### 安装开发环境

```bash
# 克隆项目
git clone https://github.com/leisai/python-l7-driver.git
cd python-l7-driver

# 安装开发依赖
pip install -e .[dev]

# 运行测试
pytest

# 代码格式化
black leisai/

# 类型检查
mypy leisai/
```

### 项目规范

1. **代码风格**：遵循PEP8，使用black格式化
2. **类型注解**：所有公共API必须有类型注解
3. **文档字符串**：使用NumPy风格的docstring
4. **测试覆盖**：新功能必须有对应测试
5. **版本管理**：遵循语义化版本规范

## 🎨 设计理念

### 1. 模块化架构

```
应用层     ->  L7Driver (主接口)
   ↓
业务层     ->  ParameterManager, MotionController, StatusMonitor
   ↓ 
协议层     ->  ModbusClient, ModbusRTU
   ↓
物理层     ->  SerialConnection
```

### 2. 错误处理

```
L7Exception (基类)
├── CommunicationError (通信错误)
│   ├── ConnectionError
│   ├── TimeoutError
│   └── ModbusError
├── ParameterError (参数错误)
│   ├── InvalidParameterError
│   └── ParameterOutOfRangeError
└── ControlError (控制错误)
    ├── ServoNotReadyError
    └── MotionError
```

### 3. 常量管理

所有常量集中在`constants.py`中定义，包括：
- 控制模式枚举
- 状态枚举
- 报警代码
- 参数地址映射
- 物理限制值

## 📝 版本历史

- **v1.0.0** (2025-01-04)
  - 首次发布
  - 完整的Modbus RTU实现
  - 支持L7全系列驱动器

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

1. Fork项目
2. 创建功能分支
3. 提交代码
4. 编写测试
5. 提交PR

## 📄 许可证

MIT License - 允许商业使用

## 📞 联系方式

- 技术支持：support@leisai.com
- 官方网站：www.leisai.com
- GitHub：https://github.com/leisai/python-l7-driver

---

**作者**：Leisai Python Driver Team  
**版本**：1.0.0  
**更新**：2025-01-04